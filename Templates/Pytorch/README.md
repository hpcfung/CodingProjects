TO DO: tidy up code (more condensed; remove extraneous stuff; add comments to explain code structure of pytorch)
